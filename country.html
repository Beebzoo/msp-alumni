<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Country - MSP Alumni Network</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        :root {
            --dark-blue: #001C3D;
            --light-blue: #00A2DB;
            --orange: #E84E10;
            --white: #FFFFFF;
            --off-white: #f8f9fa;
            --gray-100: #f5f5f5;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-500: #adb5bd;
            --gray-600: #6c757d;
            --gray-800: #343a40;
            --text-dark: #1a1a2e;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--white);
            color: var(--text-dark);
            line-height: 1.6;
        }
        
        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            border-bottom: 1px solid var(--gray-200);
        }
        
        .logo {
            font-size: 14px;
            font-weight: 700;
            color: var(--dark-blue);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-mark {
            width: 32px;
            height: 32px;
            background: var(--dark-blue);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 11px;
            font-weight: 800;
        }
        
        .back-link {
            font-size: 14px;
            color: var(--light-blue);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: color 0.2s;
        }
        
        .back-link:hover {
            color: var(--dark-blue);
        }
        
        /* Hero Section */
        .hero {
            min-height: 100vh;
            display: grid;
            grid-template-columns: 1fr 1fr;
            padding-top: 65px;
        }
        
        .hero-left {
            display: flex;
            flex-direction: column;
        }
        
        .flag-section {
            flex: 1;
            position: relative;
            overflow: hidden;
            min-height: 320px;
        }
        
        .flag-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .flag-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 120px;
            background: linear-gradient(to bottom, transparent, var(--dark-blue));
        }
        
        .info-section {
            background: var(--dark-blue);
            padding: 45px 50px;
            color: white;
        }
        
        .country-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--light-blue);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 12px;
        }
        
        .country-name {
            font-size: 44px;
            font-weight: 800;
            letter-spacing: -1.5px;
            line-height: 1.1;
            margin-bottom: 8px;
            color: white;
        }
        
        .country-native {
            font-size: 15px;
            color: rgba(255,255,255,0.5);
            font-style: italic;
            margin-bottom: 20px;
        }
        
        .country-region {
            font-size: 14px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 30px;
        }
        
        .quick-facts {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        .fact {
            border-left: 3px solid var(--light-blue);
            padding-left: 12px;
        }
        
        .fact.orange {
            border-left-color: var(--orange);
        }
        
        .fact-value {
            font-size: 16px;
            font-weight: 700;
            color: white;
        }
        
        .fact-label {
            font-size: 10px;
            color: rgba(255,255,255,0.5);
            margin-top: 3px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Map */
        .hero-right {
            position: relative;
            background: var(--gray-100);
        }
        
        #heroMap {
            width: 100%;
            height: 100%;
            min-height: 500px;
        }
        
        .map-overlay {
            position: absolute;
            bottom: 25px;
            left: 25px;
            background: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .map-overlay-title {
            font-size: 11px;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .map-overlay-value {
            font-size: 28px;
            font-weight: 800;
            color: var(--dark-blue);
        }
        
        /* UM Style Section Headers */
        .section-header-um {
            margin-bottom: 30px;
        }
        
        .section-header-um h2 {
            font-size: 28px;
            font-weight: 700;
            color: var(--dark-blue);
            margin-bottom: 8px;
        }
        
        .section-header-um p {
            font-size: 15px;
            color: var(--gray-600);
            max-width: 600px;
        }
        
        /* Stats Section - UM Style */
        .stats-section {
            padding: 70px 50px;
            background: white;
        }
        
        .stats-container {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .stats-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
        }
        
        .stat-card {
            background: var(--gray-100);
            padding: 35px 30px;
            border-left: 4px solid var(--orange);
        }
        
        .stat-card.blue {
            border-left-color: var(--light-blue);
        }
        
        .stat-number {
            font-size: 48px;
            font-weight: 800;
            color: var(--dark-blue);
            line-height: 1;
            margin-bottom: 8px;
        }
        
        .stat-label {
            font-size: 14px;
            color: var(--gray-600);
        }
        
        /* Graphs Section - UM Style */
        .graphs-section {
            padding: 70px 50px;
            background: var(--gray-100);
        }
        
        .graphs-container {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .graphs-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 30px;
        }
        
        .graph-card-um {
            background: white;
            padding: 30px;
        }
        
        .graph-card-um.full-width {
            grid-column: span 2;
        }
        
        .graph-title-um {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark-blue);
            margin-bottom: 25px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        /* Bar Chart - UM Style */
        .bar-chart-um {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }
        
        .bar-row-um {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .bar-label-um {
            font-size: 14px;
            color: var(--gray-800);
            min-width: 140px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bar-flag {
            width: 24px;
            height: 16px;
            border-radius: 2px;
            object-fit: cover;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .bar-track {
            flex: 1;
            height: 24px;
            background: var(--gray-100);
            position: relative;
        }
        
        .bar-fill-um {
            height: 100%;
            background: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 10px;
            font-size: 12px;
            font-weight: 600;
            color: white;
            min-width: 35px;
        }
        
        .bar-fill-um.orange {
            background: var(--orange);
        }
        
        .bar-fill-um.dark {
            background: var(--dark-blue);
        }
        
        /* Donut Chart */
        .donut-container {
            display: flex;
            align-items: center;
            gap: 35px;
        }
        
        .donut-chart {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .donut-center {
            width: 90px;
            height: 90px;
            background: white;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .donut-center-value {
            font-size: 26px;
            font-weight: 800;
            color: var(--dark-blue);
        }
        
        .donut-center-label {
            font-size: 10px;
            color: var(--gray-600);
            text-transform: uppercase;
        }
        
        .donut-legend {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }
        
        .legend-color {
            width: 16px;
            height: 16px;
        }
        
        .legend-value {
            font-weight: 600;
            margin-left: auto;
            color: var(--dark-blue);
        }
        
        /* Year Timeline - UM Style */
        .year-timeline-um {
            display: flex;
            align-items: flex-end;
            gap: 6px;
            height: 180px;
            padding-top: 25px;
        }
        
        .year-bar-um {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }
        
        .year-bar-fill-um {
            width: 100%;
            background: var(--light-blue);
            position: relative;
            min-height: 8px;
        }
        
        .year-bar-value-um {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            font-weight: 600;
            color: var(--dark-blue);
        }
        
        .year-bar-label-um {
            font-size: 10px;
            color: var(--gray-600);
        }
        
        /* Universities Section - UM Style Cards */
        .universities-section {
            padding: 70px 50px;
            background: white;
        }
        
        .universities-container {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .uni-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
        }
        
        .uni-card {
            background: white;
            border: 1px solid var(--gray-200);
            transition: box-shadow 0.2s, transform 0.2s;
            text-decoration: none;
            color: inherit;
            display: block;
        }
        
        .uni-card:hover {
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .uni-card-header {
            height: 100px;
            background: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .uni-card-header img {
            max-height: 60px;
            max-width: 140px;
            object-fit: contain;
        }
        
        .uni-card-body {
            padding: 20px;
        }
        
        .uni-card-name {
            font-size: 15px;
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 4px;
            line-height: 1.3;
        }
        
        .uni-card-city {
            font-size: 13px;
            color: var(--gray-600);
            margin-bottom: 15px;
        }
        
        .uni-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 15px;
            border-top: 1px solid var(--gray-200);
        }
        
        .uni-card-count {
            font-size: 24px;
            font-weight: 700;
            color: var(--dark-blue);
        }
        
        .uni-card-count span {
            font-size: 13px;
            font-weight: 400;
            color: var(--gray-600);
        }
        
        .uni-card-link {
            color: var(--orange);
            font-size: 20px;
        }
        
        /* Cities Section - UM Style Buttons */
        .cities-section {
            padding: 70px 50px;
            background: var(--gray-100);
        }
        
        .cities-container {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .cities-grid-um {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-top: 30px;
        }
        
        .city-button {
            background: var(--orange);
            color: white;
            padding: 14px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s;
        }
        
        .city-button:hover {
            background: #d63d0a;
        }
        
        .city-button span {
            font-weight: 700;
        }
        
        .city-button-alt {
            background: white;
            color: var(--dark-blue);
            border: 1px solid var(--gray-300);
        }
        
        .city-button-alt:hover {
            background: var(--gray-100);
        }
        
        /* Footer */
        footer {
            padding: 40px 50px;
            background: var(--dark-blue);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .footer-logo {
            color: white;
            font-size: 14px;
            font-weight: 500;
        }
        
        .footer-links {
            display: flex;
            gap: 25px;
        }
        
        .footer-links a {
            color: rgba(255,255,255,0.6);
            text-decoration: none;
            font-size: 13px;
            transition: color 0.2s;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        /* Leaflet Popups */
        .leaflet-popup-content-wrapper {
            background: white;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            padding: 0;
        }
        
        .leaflet-popup-content {
            margin: 0;
            font-family: 'Inter', sans-serif;
            min-width: 200px;
        }
        
        .leaflet-popup-tip {
            background: white;
        }
        
        .popup-card {
            padding: 18px;
        }
        
        .popup-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .popup-logo {
            width: 45px;
            height: 45px;
            background: var(--gray-100);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 6px;
        }
        
        .popup-logo img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .popup-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark-blue);
            line-height: 1.2;
        }
        
        .popup-city {
            font-size: 12px;
            color: var(--gray-600);
            margin-top: 2px;
        }
        
        .popup-stats {
            display: flex;
            align-items: baseline;
            gap: 6px;
            padding-top: 12px;
            border-top: 1px solid var(--gray-200);
        }
        
        .popup-count {
            font-size: 28px;
            font-weight: 700;
            color: var(--light-blue);
        }
        
        .popup-count-label {
            font-size: 12px;
            color: var(--gray-600);
        }
        
        /* Responsive */
        @media (max-width: 1100px) {
            .hero {
                grid-template-columns: 1fr;
            }
            
            .hero-right {
                height: 400px;
            }
            
            .stats-row {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .graphs-grid {
                grid-template-columns: 1fr;
            }
            
            .graph-card-um.full-width {
                grid-column: span 1;
            }
            
            .uni-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .cities-grid-um {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            header {
                padding: 12px 20px;
            }
            
            .info-section {
                padding: 30px 25px;
            }
            
            .country-name {
                font-size: 32px;
            }
            
            .quick-facts {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }
            
            .stats-section,
            .graphs-section,
            .universities-section,
            .cities-section {
                padding: 50px 25px;
            }
            
            .stats-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .stat-card {
                padding: 25px 20px;
            }
            
            .stat-number {
                font-size: 40px;
            }
            
            .donut-container {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .bar-label-um {
                min-width: 100px;
                font-size: 12px;
            }
            
            .uni-grid {
                grid-template-columns: 1fr;
            }
            
            .cities-grid-um {
                grid-template-columns: repeat(2, 1fr);
            }
            
            footer {
                flex-direction: column;
                gap: 20px;
                text-align: center;
                padding: 30px 25px;
            }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header>
        <a href="index.html" class="logo">
            <span class="logo-mark">UM</span>
            MSP Alumni Network
        </a>
        <a href="index.html" class="back-link">← Back to World Map</a>
    </header>
    
    <!-- Hero -->
    <section class="hero">
        <div class="hero-left">
            <div class="flag-section">
                <img id="flagImg" class="flag-img" src="" alt="Flag">
                <div class="flag-overlay"></div>
            </div>
            <div class="info-section">
                <div class="country-label">Country Profile</div>
                <h1 class="country-name" id="countryName">the Netherlands</h1>
                <p class="country-native" id="countryNative"></p>
                <p class="country-region" id="countryRegion"></p>
                
                <div class="quick-facts">
                    <div class="fact">
                        <div class="fact-value" id="factCapital">-</div>
                        <div class="fact-label">Capital</div>
                    </div>
                    <div class="fact">
                        <div class="fact-value" id="factPopulation">-</div>
                        <div class="fact-label">Population</div>
                    </div>
                    <div class="fact orange">
                        <div class="fact-value" id="factArea">-</div>
                        <div class="fact-label">Area (km²)</div>
                    </div>
                    <div class="fact">
                        <div class="fact-value" id="factCurrency">-</div>
                        <div class="fact-label">Currency</div>
                    </div>
                    <div class="fact">
                        <div class="fact-value" id="factLanguage">-</div>
                        <div class="fact-label">Language</div>
                    </div>
                    <div class="fact orange">
                        <div class="fact-value" id="factTimezone">-</div>
                        <div class="fact-label">Timezone</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="hero-right">
            <div id="heroMap"></div>
            <div class="map-overlay">
                <div class="map-overlay-title">Universities</div>
                <div class="map-overlay-value" id="uniCount">11</div>
            </div>
        </div>
    </section>
    
    <!-- Stats Section -->
    <section class="stats-section">
        <div class="stats-container">
            <div class="section-header-um">
                <h2>MSP Alumni Statistics</h2>
                <p>Overview of Maastricht Science Programme graduates connected to this country.</p>
            </div>
            <div class="stats-row">
                <div class="stat-card">
                    <div class="stat-number" id="statTotal">487</div>
                    <div class="stat-label">Total Alumni</div>
                </div>
                <div class="stat-card blue">
                    <div class="stat-number" id="statLiving">445</div>
                    <div class="stat-label">Currently Living Here</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="statUnis">11</div>
                    <div class="stat-label">Partner Universities</div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Graphs Section -->
    <section class="graphs-section">
        <div class="graphs-container">
            <div class="section-header-um">
                <h2>Alumni Demographics</h2>
                <p>Detailed breakdown of alumni characteristics and trends.</p>
            </div>
            
            <div class="graphs-grid">
                <!-- Graduation Years -->
                <div class="graph-card-um full-width">
                    <div class="graph-title-um">Alumni by Graduation Year</div>
                    <div class="year-timeline-um" id="yearTimeline"></div>
                </div>
                
                <!-- Gender -->
                <div class="graph-card-um">
                    <div class="graph-title-um">Gender Distribution</div>
                    <div class="donut-container">
                        <div class="donut-chart" id="genderDonut"></div>
                        <div class="donut-legend" id="genderLegend"></div>
                    </div>
                </div>
                
                <!-- Origins -->
                <div class="graph-card-um">
                    <div class="graph-title-um">Where They Come From</div>
                    <div class="bar-chart-um" id="originChart"></div>
                </div>
                
                <!-- Fields -->
                <div class="graph-card-um full-width">
                    <div class="graph-title-um">Fields of Study</div>
                    <div class="bar-chart-um" id="fieldsChart"></div>
                </div>
                
                <!-- Nationalities -->
                <div class="graph-card-um full-width">
                    <div class="graph-title-um">Top Nationalities</div>
                    <div class="bar-chart-um" id="nationalitiesChart"></div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Universities Section -->
    <section class="universities-section">
        <div class="universities-container">
            <div class="section-header-um">
                <h2>Universities</h2>
                <p>Institutions where MSP alumni have continued their academic journey.</p>
            </div>
            
            <div class="uni-grid" id="universityGrid"></div>
        </div>
    </section>
    
    <!-- Cities Section -->
    <section class="cities-section">
        <div class="cities-container">
            <div class="section-header-um">
                <h2>Where Alumni Live</h2>
                <p>Cities across the country where our graduates have settled.</p>
            </div>
            
            <div class="cities-grid-um" id="citiesGrid"></div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer>
        <div class="footer-logo">Maastricht University · Faculty of Science and Engineering</div>
        <div class="footer-links">
            <a href="index.html">World Map</a>
            <a href="#">Contact</a>
        </div>
    </footer>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // ============================================
        // CONFIG
        // ============================================
        
        const urlParams = new URLSearchParams(window.location.search);
        const countryParam = urlParams.get('country') || 'Netherlands';
        
        const nationalityFlags = {
            "Dutch": "nl", "German": "de", "Belgian": "be", "Italian": "it",
            "British": "gb", "Spanish": "es", "Polish": "pl", "Romanian": "ro",
            "French": "fr", "American": "us", "Chinese": "cn", "Indian": "in",
            "Greek": "gr", "Portuguese": "pt", "Swedish": "se", "Austrian": "at",
            "Swiss": "ch", "Danish": "dk", "Finnish": "fi", "Norwegian": "no",
            "Irish": "ie", "Czech": "cz", "Hungarian": "hu", "Bulgarian": "bg",
            "Croatian": "hr", "Turkish": "tr", "Russian": "ru", "Ukrainian": "ua",
            "Brazilian": "br", "Mexican": "mx", "Canadian": "ca", "Australian": "au",
            "Japanese": "jp", "Korean": "kr"
        };
        
        // ============================================
        // DATA (Privacy compliant: all n>=5)
        // ============================================
        
        const alumniDatabase = {
            "Netherlands": {
                code: "NL",
                displayName: "the Netherlands",
                total: 487,
                living: 445,
                coordinates: [52.1326, 5.2913],
                zoom: 7,
                graduationYears: {
                    2014: 5, 2015: 10, 2016: 22, 2017: 22, 2018: 19, 2019: 24,
                    2020: 40, 2021: 50, 2022: 52, 2023: 63, 2024: 65, 2025: 73
                },
                gender: { Female: 265, Male: 180 },
                origins: {
                    "International": 272,
                    "Euregio": 71,
                    "Netherlands": 51,
                    "Limburg": 51
                },
                nationalities: {
                    "Dutch": 151, "German": 43, "Belgian": 34, "Italian": 26,
                    "British": 17, "Spanish": 17, "Polish": 15, "Romanian": 11, "French": 9
                },
                fields: {
                    "Life Sciences": 103,
                    "Biology & Ecology": 68,
                    "Neuroscience": 37,
                    "Physical Sciences": 36,
                    "Business & Economics": 32,
                    "Chemistry": 30,
                    "Medicine & Health": 22,
                    "Computer Science": 18
                },
                universities: [
                    { name: "Maastricht University", city: "Maastricht", count: 121, lat: 50.8514, lng: 5.6910, logo: "maastricht-university.png" },
                    { name: "Utrecht University", city: "Utrecht", count: 82, lat: 52.0855, lng: 5.1744, logo: "utrecht-university.png" },
                    { name: "University of Amsterdam", city: "Amsterdam", count: 58, lat: 52.3559, lng: 4.9552, logo: "university-of-amsterdam.png" },
                    { name: "Leiden University", city: "Leiden", count: 41, lat: 52.1575, lng: 4.4856, logo: "leiden-university.png" },
                    { name: "Wageningen University", city: "Wageningen", count: 37, lat: 51.9692, lng: 5.6654, logo: "wageningen-university.png" },
                    { name: "Radboud University", city: "Nijmegen", count: 36, lat: 51.8207, lng: 5.8656, logo: "radboud-university.png" },
                    { name: "University of Groningen", city: "Groningen", count: 23, lat: 53.2194, lng: 6.5665, logo: "university-of-groningen.png" },
                    { name: "TU Delft", city: "Delft", count: 17, lat: 52.0021, lng: 4.3734, logo: "tu-delft.png" },
                    { name: "VU Amsterdam", city: "Amsterdam", count: 14, lat: 52.3340, lng: 4.8668, logo: "vrije-universiteit-amsterdam.png" },
                    { name: "TU Eindhoven", city: "Eindhoven", count: 9, lat: 51.4478, lng: 5.4904, logo: "eindhoven-university.png" },
                    { name: "Erasmus University", city: "Rotterdam", count: 5, lat: 51.9173, lng: 4.5260, logo: "erasmus-university.png" }
                ],
                cities: [
                    { name: "Maastricht", count: 100 },
                    { name: "Amsterdam", count: 92 },
                    { name: "Utrecht", count: 71 },
                    { name: "Leiden", count: 34 },
                    { name: "Wageningen", count: 18 },
                    { name: "Groningen", count: 18 },
                    { name: "Nijmegen", count: 18 },
                    { name: "Eindhoven", count: 10 },
                    { name: "Rotterdam", count: 8 },
                    { name: "The Hague", count: 7 },
                    { name: "Delft", count: 7 }
                ]
            }
        };
        
        const countryData = alumniDatabase[countryParam] || alumniDatabase["Netherlands"];
        
        // ============================================
        // FETCH COUNTRY INFO
        // ============================================
        
        async function fetchCountryInfo() {
            try {
                const response = await fetch(`https://restcountries.com/v3.1/alpha/${countryData.code}`);
                const data = await response.json();
                const country = data[0];
                
                document.title = `${countryData.displayName} - MSP Alumni`;
                document.getElementById('flagImg').src = country.flags.svg;
                document.getElementById('countryName').textContent = countryData.displayName;
                
                const nativeNames = country.name.nativeName;
                if (nativeNames) {
                    const firstNative = Object.values(nativeNames)[0];
                    if (firstNative.common && firstNative.common !== country.name.common) {
                        document.getElementById('countryNative').textContent = firstNative.common;
                    }
                }
                
                document.getElementById('countryRegion').textContent = `${country.subregion} · ${country.region}`;
                document.getElementById('factCapital').textContent = country.capital?.[0] || '-';
                document.getElementById('factPopulation').textContent = formatPopulation(country.population);
                document.getElementById('factArea').textContent = formatNumber(country.area);
                
                if (country.currencies) {
                    const currencyKey = Object.keys(country.currencies)[0];
                    const currency = country.currencies[currencyKey];
                    document.getElementById('factCurrency').textContent = `${currency.symbol || ''} ${currencyKey}`;
                }
                
                if (country.languages) {
                    document.getElementById('factLanguage').textContent = Object.values(country.languages)[0];
                }
                
                if (country.timezones) {
                    document.getElementById('factTimezone').textContent = country.timezones[0];
                }
            } catch (error) {
                console.error('Error:', error);
            }
        }
        
        // ============================================
        // HELPERS
        // ============================================
        
        function formatPopulation(num) {
            if (num >= 1e9) return (num / 1e9).toFixed(1) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(0) + 'K';
            return num.toString();
        }
        
        function formatNumber(num) {
            return num?.toLocaleString() || '-';
        }
        
        function getFlagUrl(code) {
            return `https://flagcdn.com/w40/${code}.png`;
        }
        
        // ============================================
        // MAP
        // ============================================
        
        function initMap() {
            const map = L.map('heroMap', {
                zoomControl: false,
                attributionControl: false
            }).setView(countryData.coordinates, countryData.zoom);
            
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);
            
            countryData.universities.forEach(uni => {
                const size = Math.max(10, Math.min(uni.count / 4, 25));
                
                const marker = L.circleMarker([uni.lat, uni.lng], {
                    radius: size,
                    fillColor: '#00A2DB',
                    color: '#ffffff',
                    weight: 2,
                    opacity: 1,
                    fillOpacity: 0.85
                }).addTo(map);
                
                marker.bindPopup(`
                    <div class="popup-card">
                        <div class="popup-header">
                            <div class="popup-logo">
                                <img src="assets/logos/${uni.logo}" alt="${uni.name}" onerror="this.parentElement.style.display='none'">
                            </div>
                            <div>
                                <div class="popup-name">${uni.name}</div>
                                <div class="popup-city">${uni.city}</div>
                            </div>
                        </div>
                        <div class="popup-stats">
                            <div class="popup-count">${uni.count}</div>
                            <div class="popup-count-label">alumni</div>
                        </div>
                    </div>
                `, { maxWidth: 260 });
                
                marker.on('mouseover', function() {
                    this.setStyle({ fillOpacity: 1, radius: size * 1.15 });
                });
                marker.on('mouseout', function() {
                    this.setStyle({ fillOpacity: 0.85, radius: size });
                });
            });
        }
        
        // ============================================
        // STATS
        // ============================================
        
        function populateStats() {
            document.getElementById('statTotal').textContent = countryData.total;
            document.getElementById('statLiving').textContent = countryData.living;
            document.getElementById('statUnis').textContent = countryData.universities.length;
            document.getElementById('uniCount').textContent = countryData.universities.length;
        }
        
        // ============================================
        // CHARTS
        // ============================================
        
        function createYearTimeline() {
            const container = document.getElementById('yearTimeline');
            const years = countryData.graduationYears;
            const maxVal = Math.max(...Object.values(years));
            
            Object.entries(years).forEach(([year, count]) => {
                const height = (count / maxVal) * 130;
                const bar = document.createElement('div');
                bar.className = 'year-bar-um';
                bar.innerHTML = `
                    <div class="year-bar-fill-um" style="height: ${height}px">
                        <span class="year-bar-value-um">${count}</span>
                    </div>
                    <div class="year-bar-label-um">'${year.slice(-2)}</div>
                `;
                container.appendChild(bar);
            });
        }
        
        function createGenderDonut() {
            const female = countryData.gender.Female;
            const male = countryData.gender.Male;
            const total = female + male;
            const femalePct = (female / total) * 100;
            
            const donut = document.getElementById('genderDonut');
            donut.style.background = `conic-gradient(#00A2DB 0% ${femalePct}%, #E84E10 ${femalePct}% 100%)`;
            donut.innerHTML = `<div class="donut-center"><div class="donut-center-value">${total}</div><div class="donut-center-label">Total</div></div>`;
            
            document.getElementById('genderLegend').innerHTML = `
                <div class="legend-item"><div class="legend-color" style="background:#00A2DB"></div><span>Female</span><span class="legend-value">${female} (${femalePct.toFixed(0)}%)</span></div>
                <div class="legend-item"><div class="legend-color" style="background:#E84E10"></div><span>Male</span><span class="legend-value">${male} (${(100-femalePct).toFixed(0)}%)</span></div>
            `;
        }
        
        function createBarChart(containerId, data, colorClass = '') {
            const container = document.getElementById(containerId);
            const maxVal = Math.max(...Object.values(data));
            
            Object.entries(data).forEach(([label, value]) => {
                const pct = (value / maxVal) * 100;
                const row = document.createElement('div');
                row.className = 'bar-row-um';
                row.innerHTML = `
                    <div class="bar-label-um">${label}</div>
                    <div class="bar-track"><div class="bar-fill-um ${colorClass}" style="width: ${pct}%">${value}</div></div>
                `;
                container.appendChild(row);
            });
        }
        
        function createNationalitiesChart() {
            const container = document.getElementById('nationalitiesChart');
            const data = countryData.nationalities;
            const maxVal = Math.max(...Object.values(data));
            
            Object.entries(data).forEach(([nationality, value]) => {
                const pct = (value / maxVal) * 100;
                const flagCode = nationalityFlags[nationality] || '';
                const flagHtml = flagCode ? `<img src="${getFlagUrl(flagCode)}" alt="" class="bar-flag">` : '';
                
                const row = document.createElement('div');
                row.className = 'bar-row-um';
                row.innerHTML = `
                    <div class="bar-label-um">${flagHtml}${nationality}</div>
                    <div class="bar-track"><div class="bar-fill-um orange" style="width: ${pct}%">${value}</div></div>
                `;
                container.appendChild(row);
            });
        }
        
        // ============================================
        // UNIVERSITIES - Card Grid
        // ============================================
        
        function populateUniversities() {
            const grid = document.getElementById('universityGrid');
            
            countryData.universities.forEach(uni => {
                const card = document.createElement('a');
                card.href = `university.html?name=${encodeURIComponent(uni.name)}`;
                card.className = 'uni-card';
                card.innerHTML = `
                    <div class="uni-card-header">
                        <img src="assets/logos/${uni.logo}" alt="${uni.name}" onerror="this.style.display='none'">
                    </div>
                    <div class="uni-card-body">
                        <div class="uni-card-name">${uni.name}</div>
                        <div class="uni-card-city">${uni.city}</div>
                        <div class="uni-card-footer">
                            <div class="uni-card-count">${uni.count} <span>alumni</span></div>
                            <div class="uni-card-link">→</div>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
        
        // ============================================
        // CITIES - UM Style Buttons
        // ============================================
        
        function populateCities() {
            const grid = document.getElementById('citiesGrid');
            
            countryData.cities.forEach((city, i) => {
                const btn = document.createElement('div');
                btn.className = i < 4 ? 'city-button' : 'city-button city-button-alt';
                btn.innerHTML = `${city.name} <span>${city.count}</span>`;
                grid.appendChild(btn);
            });
        }
        
        // ============================================
        // INIT
        // ============================================
        
        fetchCountryInfo();
        populateStats();
        initMap();
        createYearTimeline();
        createGenderDonut();
        createBarChart('originChart', countryData.origins, '');
        createBarChart('fieldsChart', countryData.fields, 'dark');
        createNationalitiesChart();
        populateUniversities();
        populateCities();
    </script>
</body>
</html>
