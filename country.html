<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Country - MSP Alumni Network</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        :root {
            --dark-blue: #001C3D;
            --light-blue: #00A2DB;
            --orange: #E84E10;
            --white: #FFFFFF;
            --off-white: #f8f9fa;
            --gray-100: #f5f5f5;
            --gray-200: #e9ecef;
            --gray-300: #dee2e6;
            --gray-600: #6c757d;
            --gray-800: #343a40;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            font-size: 16px;
            line-height: 1.6;
            color: var(--dark-blue);
            background: var(--white);
        }
        
        /* Header */
        header {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 15px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 12px;
            text-decoration: none;
        }
        
        .logo-icon {
            width: 36px;
            height: 36px;
            background: var(--dark-blue);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 12px;
        }
        
        .logo-text {
            font-size: 15px;
            font-weight: 700;
            color: var(--dark-blue);
        }
        
        .back-link {
            font-size: 14px;
            color: var(--light-blue);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .back-link:hover {
            color: var(--dark-blue);
        }
        
        /* Hero */
        .hero {
            display: grid;
            grid-template-columns: 1fr 1fr;
            min-height: calc(100vh - 70px);
        }
        
        .hero-left {
            display: flex;
            flex-direction: column;
        }
        
        .flag-section {
            flex: 1;
            position: relative;
            overflow: hidden;
            min-height: 280px;
        }
        
        .flag-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .flag-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: linear-gradient(to bottom, transparent, var(--dark-blue));
        }
        
        .info-section {
            background: var(--dark-blue);
            padding: 40px 45px;
            color: white;
        }
        
        .country-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--light-blue);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 12px;
        }
        
        .country-name {
            font-size: 42px;
            font-weight: 800;
            letter-spacing: -1.5px;
            line-height: 1.1;
            margin-bottom: 8px;
        }
        
        .country-native {
            font-size: 15px;
            color: rgba(255,255,255,0.5);
            font-style: italic;
            margin-bottom: 15px;
        }
        
        .country-region {
            font-size: 14px;
            color: rgba(255,255,255,0.7);
            margin-bottom: 30px;
        }
        
        .quick-facts {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 18px;
        }
        
        .fact {
            border-left: 3px solid var(--light-blue);
            padding-left: 12px;
        }
        
        .fact.orange {
            border-left-color: var(--orange);
        }
        
        .fact-value {
            font-size: 15px;
            font-weight: 700;
        }
        
        .fact-label {
            font-size: 10px;
            color: rgba(255,255,255,0.5);
            margin-top: 2px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Hero Right - Map */
        .hero-right {
            position: relative;
            background: var(--gray-100);
        }
        
        #heroMap {
            width: 100%;
            height: 100%;
            min-height: 450px;
        }
        
        .map-overlay {
            position: absolute;
            bottom: 25px;
            left: 25px;
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .map-overlay-title {
            font-size: 11px;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .map-overlay-value {
            font-size: 28px;
            font-weight: 800;
            color: var(--dark-blue);
        }
        
        /* Stats Section */
        .stats-section {
            padding: 70px 50px;
            background: white;
        }
        
        .stats-container {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .section-header {
            margin-bottom: 30px;
        }
        
        .section-header h2 {
            font-size: 26px;
            font-weight: 700;
            color: var(--dark-blue);
            margin-bottom: 8px;
        }
        
        .section-header p {
            font-size: 15px;
            color: var(--gray-600);
        }
        
        .stats-row {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
        }
        
        .stat-card {
            background: var(--gray-100);
            padding: 30px 25px;
            border-left: 4px solid var(--orange);
        }
        
        .stat-card.blue {
            border-left-color: var(--light-blue);
        }
        
        .stat-number {
            font-size: 44px;
            font-weight: 800;
            color: var(--dark-blue);
            line-height: 1;
            margin-bottom: 8px;
        }
        
        .stat-label {
            font-size: 14px;
            color: var(--gray-600);
        }
        
        /* Graphs Section */
        .graphs-section {
            padding: 70px 50px;
            background: var(--gray-100);
        }
        
        .graphs-container {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .graphs-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 25px;
        }
        
        .graph-card {
            background: white;
            padding: 28px;
        }
        
        .graph-card.full-width {
            grid-column: span 2;
        }
        
        .graph-title {
            font-size: 17px;
            font-weight: 700;
            color: var(--dark-blue);
            margin-bottom: 22px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--gray-200);
        }
        
        /* Bar Chart */
        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .bar-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .bar-label {
            font-size: 13px;
            color: var(--gray-800);
            min-width: 130px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .bar-flag {
            width: 22px;
            height: 15px;
            border-radius: 2px;
            object-fit: cover;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        
        .bar-track {
            flex: 1;
            height: 22px;
            background: var(--gray-100);
            position: relative;
        }
        
        .bar-fill {
            height: 100%;
            background: var(--light-blue);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 8px;
            font-size: 11px;
            font-weight: 600;
            color: white;
            min-width: 30px;
        }
        
        .bar-fill.orange { background: var(--orange); }
        .bar-fill.dark { background: var(--dark-blue); }
        
        /* Donut */
        .donut-container {
            display: flex;
            align-items: center;
            gap: 30px;
        }
        
        .donut-chart {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .donut-center {
            width: 85px;
            height: 85px;
            background: white;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .donut-center-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--dark-blue);
        }
        
        .donut-center-label {
            font-size: 10px;
            color: var(--gray-600);
            text-transform: uppercase;
        }
        
        .donut-legend {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 14px;
        }
        
        .legend-color {
            width: 14px;
            height: 14px;
        }
        
        .legend-value {
            font-weight: 600;
            margin-left: auto;
            color: var(--dark-blue);
        }
        
        /* Year Timeline */
        .year-timeline {
            display: flex;
            align-items: flex-end;
            gap: 6px;
            height: 160px;
            padding-top: 25px;
        }
        
        .year-bar {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }
        
        .year-bar-fill {
            width: 100%;
            background: var(--light-blue);
            position: relative;
            min-height: 6px;
        }
        
        .year-bar-value {
            position: absolute;
            top: -18px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 10px;
            font-weight: 600;
            color: var(--dark-blue);
        }
        
        .year-bar-label {
            font-size: 10px;
            color: var(--gray-600);
        }
        
        /* Universities Section */
        .universities-section {
            padding: 70px 50px;
            background: white;
        }
        
        .universities-container {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .uni-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }
        
        .uni-card {
            background: white;
            border: 1px solid var(--gray-200);
            transition: all 0.2s;
            text-decoration: none;
            color: inherit;
        }
        
        .uni-card:hover {
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transform: translateY(-2px);
        }
        
        .uni-card-header {
            height: 80px;
            background: var(--gray-100);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 12px;
        }
        
        .uni-card-header img {
            max-height: 50px;
            max-width: 110px;
            object-fit: contain;
        }
        
        .uni-card-body {
            padding: 18px;
        }
        
        .uni-card-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 3px;
            line-height: 1.3;
        }
        
        .uni-card-city {
            font-size: 12px;
            color: var(--gray-600);
            margin-bottom: 12px;
        }
        
        .uni-card-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 12px;
            border-top: 1px solid var(--gray-200);
        }
        
        .uni-card-count {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-blue);
        }
        
        .uni-card-count span {
            font-size: 11px;
            font-weight: 400;
            color: var(--gray-600);
        }
        
        .uni-card-arrow {
            color: var(--orange);
            font-size: 16px;
        }
        
        /* Cities Section */
        .cities-section {
            padding: 70px 50px;
            background: var(--gray-100);
        }
        
        .cities-container {
            max-width: 1100px;
            margin: 0 auto;
        }
        
        .cities-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin-top: 25px;
        }
        
        .city-button {
            background: var(--orange);
            color: white;
            padding: 14px 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            font-weight: 500;
        }
        
        .city-button span {
            font-weight: 700;
        }
        
        .city-button.alt {
            background: white;
            color: var(--dark-blue);
            border: 1px solid var(--gray-200);
        }
        
        /* Coming Soon */
        .coming-soon {
            text-align: center;
            padding: 60px 20px;
            background: var(--gray-100);
            border-radius: 12px;
        }
        
        .coming-soon-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }
        
        .coming-soon h3 {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-blue);
            margin-bottom: 10px;
        }
        
        .coming-soon p {
            font-size: 15px;
            color: var(--gray-600);
            max-width: 400px;
            margin: 0 auto;
        }
        
        /* Footer */
        footer {
            padding: 40px 50px;
            background: var(--dark-blue);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .footer-logo {
            color: white;
            font-size: 14px;
            font-weight: 500;
        }
        
        .footer-links {
            display: flex;
            gap: 25px;
        }
        
        .footer-links a {
            color: rgba(255,255,255,0.6);
            text-decoration: none;
            font-size: 13px;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        /* Leaflet Popup */
        .leaflet-popup-content-wrapper {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            padding: 0;
        }
        
        .leaflet-popup-content {
            margin: 0;
            font-family: 'Inter', sans-serif;
            min-width: 200px;
        }
        
        .leaflet-popup-tip {
            background: white;
        }
        
        .popup-card {
            padding: 16px;
        }
        
        .popup-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .popup-logo {
            width: 40px;
            height: 40px;
            background: var(--gray-100);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 5px;
        }
        
        .popup-logo img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .popup-name {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark-blue);
        }
        
        .popup-city {
            font-size: 12px;
            color: var(--gray-600);
        }
        
        .popup-count {
            font-size: 24px;
            font-weight: 700;
            color: var(--light-blue);
            padding-top: 10px;
            border-top: 1px solid var(--gray-200);
        }
        
        .popup-count span {
            font-size: 12px;
            font-weight: 400;
            color: var(--gray-600);
        }
        
        /* Responsive */
        @media (max-width: 1000px) {
            .hero {
                grid-template-columns: 1fr;
            }
            
            .hero-right {
                height: 350px;
            }
            
            .stats-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .graphs-grid {
                grid-template-columns: 1fr;
            }
            
            .graph-card.full-width {
                grid-column: span 1;
            }
            
            .uni-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .cities-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            header {
                padding: 12px 20px;
            }
            
            .info-section {
                padding: 30px 20px;
            }
            
            .country-name {
                font-size: 32px;
            }
            
            .quick-facts {
                grid-template-columns: 1fr 1fr;
                gap: 12px;
            }
            
            .stats-section,
            .graphs-section,
            .universities-section,
            .cities-section {
                padding: 50px 20px;
            }
            
            .donut-container {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .bar-label {
                min-width: 90px;
                font-size: 11px;
            }
            
            .uni-grid {
                grid-template-columns: 1fr;
            }
            
            .cities-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            footer {
                flex-direction: column;
                gap: 15px;
                padding: 30px 20px;
                text-align: center;
            }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header>
        <a href="index.html" class="logo">
            <span class="logo-icon">UM</span>
            <span class="logo-text">MSP Alumni Network</span>
        </a>
        <a href="index.html" class="back-link">‚Üê Back to World Map</a>
    </header>
    
    <!-- Hero -->
    <section class="hero">
        <div class="hero-left">
            <div class="flag-section">
                <img id="flagImg" class="flag-img" src="" alt="Flag">
                <div class="flag-overlay"></div>
            </div>
            <div class="info-section">
                <div class="country-label">Country Profile</div>
                <h1 class="country-name" id="countryName">Loading...</h1>
                <p class="country-native" id="countryNative"></p>
                <p class="country-region" id="countryRegion"></p>
                
                <div class="quick-facts">
                    <div class="fact">
                        <div class="fact-value" id="factCapital">-</div>
                        <div class="fact-label">Capital</div>
                    </div>
                    <div class="fact">
                        <div class="fact-value" id="factPopulation">-</div>
                        <div class="fact-label">Population</div>
                    </div>
                    <div class="fact orange">
                        <div class="fact-value" id="factArea">-</div>
                        <div class="fact-label">Area (km¬≤)</div>
                    </div>
                    <div class="fact">
                        <div class="fact-value" id="factCurrency">-</div>
                        <div class="fact-label">Currency</div>
                    </div>
                    <div class="fact">
                        <div class="fact-value" id="factLanguage">-</div>
                        <div class="fact-label">Language</div>
                    </div>
                    <div class="fact orange">
                        <div class="fact-value" id="factTimezone">-</div>
                        <div class="fact-label">Timezone</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="hero-right">
            <div id="heroMap"></div>
            <div class="map-overlay">
                <div class="map-overlay-title">Universities</div>
                <div class="map-overlay-value" id="uniCount">-</div>
            </div>
        </div>
    </section>
    
    <!-- Stats Section -->
    <section class="stats-section">
        <div class="stats-container">
            <div class="section-header">
                <h2>MSP Alumni Statistics</h2>
                <p>Overview of Maastricht Science Programme graduates connected to this country.</p>
            </div>
            <div class="stats-row">
                <div class="stat-card">
                    <div class="stat-number" id="statTotal">-</div>
                    <div class="stat-label">Total Alumni</div>
                </div>
                <div class="stat-card blue">
                    <div class="stat-number" id="statLiving">-</div>
                    <div class="stat-label">Currently Living Here</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="statUnis">-</div>
                    <div class="stat-label">Universities</div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Graphs Section -->
    <section class="graphs-section" id="graphsSection">
        <div class="graphs-container">
            <div class="section-header">
                <h2>Alumni Demographics</h2>
                <p>Detailed breakdown of alumni characteristics and trends.</p>
            </div>
            
            <div class="graphs-grid" id="graphsGrid">
                <!-- Graduation Years -->
                <div class="graph-card full-width">
                    <div class="graph-title">Alumni by Graduation Year</div>
                    <div class="year-timeline" id="yearTimeline"></div>
                </div>
                
                <!-- Gender -->
                <div class="graph-card">
                    <div class="graph-title">Gender Distribution</div>
                    <div class="donut-container">
                        <div class="donut-chart" id="genderDonut"></div>
                        <div class="donut-legend" id="genderLegend"></div>
                    </div>
                </div>
                
                <!-- Origins -->
                <div class="graph-card">
                    <div class="graph-title">Where They Come From</div>
                    <div class="bar-chart" id="originChart"></div>
                </div>
                
                <!-- Fields -->
                <div class="graph-card full-width">
                    <div class="graph-title">Fields of Study</div>
                    <div class="bar-chart" id="fieldsChart"></div>
                </div>
                
                <!-- Nationalities -->
                <div class="graph-card full-width">
                    <div class="graph-title">Top Nationalities</div>
                    <div class="bar-chart" id="nationalitiesChart"></div>
                </div>
            </div>
        </div>
    </section>
    
    <!-- Universities Section -->
    <section class="universities-section" id="universitiesSection">
        <div class="universities-container">
            <div class="section-header">
                <h2>Universities</h2>
                <p>Institutions where MSP alumni have continued their academic journey.</p>
            </div>
            
            <div class="uni-grid" id="universityGrid"></div>
        </div>
    </section>
    
    <!-- Cities Section -->
    <section class="cities-section" id="citiesSection">
        <div class="cities-container">
            <div class="section-header">
                <h2>Where Alumni Live</h2>
                <p>Cities across the country where our graduates have settled.</p>
            </div>
            
            <div class="cities-grid" id="citiesGrid"></div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer>
        <div class="footer-logo">Maastricht University ¬∑ Faculty of Science and Engineering</div>
        <div class="footer-links">
            <a href="index.html">World Map</a>
            <a href="mailto:msp-alumni@maastrichtuniversity.nl">Contact</a>
        </div>
    </footer>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // ============================================
        // GET COUNTRY FROM URL
        // ============================================
        
        const urlParams = new URLSearchParams(window.location.search);
        const countryParam = urlParams.get('country') || 'Netherlands';
        
        // Nationality to flag code mapping
        const nationalityFlags = {
            "Dutch": "nl", "German": "de", "Belgian": "be", "Italian": "it",
            "British": "gb", "Spanish": "es", "Polish": "pl", "Romanian": "ro",
            "French": "fr", "American": "us", "Chinese": "cn", "Swedish": "se",
            "Swiss": "ch", "Austrian": "at", "Danish": "dk", "Norwegian": "no",
            "Finnish": "fi", "Irish": "ie", "Greek": "gr", "Portuguese": "pt",
            "Turkish": "tr", "Russian": "ru", "Australian": "au", "Canadian": "ca"
        };
        
        // ============================================
        // ALUMNI DATABASE - Multiple Countries
        // Privacy compliant: all groups n>=5
        // ============================================
        
        const alumniDatabase = {
            "Netherlands": {
                code: "NL",
                displayName: "the Netherlands",
                total: 487,
                living: 445,
                hasDetailedData: true,
                coordinates: [52.1326, 5.2913],
                zoom: 7,
                graduationYears: {
                    2014: 5, 2015: 10, 2016: 22, 2017: 22, 2018: 19, 2019: 24,
                    2020: 40, 2021: 50, 2022: 52, 2023: 63, 2024: 65, 2025: 73
                },
                gender: { Female: 265, Male: 180 },
                origins: {
                    "International": 272, "Euregio": 71, "Netherlands": 51, "Limburg": 51
                },
                nationalities: {
                    "Dutch": 151, "German": 43, "Belgian": 34, "Italian": 26,
                    "British": 17, "Spanish": 17, "Polish": 15, "Romanian": 11, "French": 9
                },
                fields: {
                    "Life Sciences": 103, "Biology & Ecology": 68, "Neuroscience": 37,
                    "Physical Sciences": 36, "Business & Economics": 32, "Chemistry": 30,
                    "Medicine & Health": 22, "Computer Science": 18
                },
                universities: [
                    { name: "Maastricht University", city: "Maastricht", count: 121, lat: 50.8514, lng: 5.6910, logo: "maastricht-university.png" },
                    { name: "Utrecht University", city: "Utrecht", count: 82, lat: 52.0855, lng: 5.1744, logo: "utrecht-university.png" },
                    { name: "University of Amsterdam", city: "Amsterdam", count: 58, lat: 52.3559, lng: 4.9552, logo: "university-of-amsterdam.png" },
                    { name: "Leiden University", city: "Leiden", count: 41, lat: 52.1575, lng: 4.4856, logo: "leiden-university.png" },
                    { name: "Wageningen University", city: "Wageningen", count: 37, lat: 51.9692, lng: 5.6654, logo: "wageningen-university.png" },
                    { name: "Radboud University", city: "Nijmegen", count: 36, lat: 51.8207, lng: 5.8656, logo: "radboud-university.png" },
                    { name: "University of Groningen", city: "Groningen", count: 23, lat: 53.2194, lng: 6.5665, logo: "university-of-groningen.png" },
                    { name: "TU Delft", city: "Delft", count: 17, lat: 52.0021, lng: 4.3734, logo: "tu-delft.png" },
                    { name: "VU Amsterdam", city: "Amsterdam", count: 14, lat: 52.3340, lng: 4.8668, logo: "vrije-universiteit-amsterdam.png" },
                    { name: "TU Eindhoven", city: "Eindhoven", count: 9, lat: 51.4478, lng: 5.4904, logo: "eindhoven-university.png" },
                    { name: "Erasmus University", city: "Rotterdam", count: 5, lat: 51.9173, lng: 4.5260, logo: "erasmus-university.png" }
                ],
                cities: [
                    { name: "Maastricht", count: 100 }, { name: "Amsterdam", count: 92 },
                    { name: "Utrecht", count: 71 }, { name: "Leiden", count: 34 },
                    { name: "Wageningen", count: 18 }, { name: "Groningen", count: 18 },
                    { name: "Nijmegen", count: 18 }, { name: "Eindhoven", count: 10 }
                ]
            },
            
            "Germany": {
                code: "DE",
                displayName: "Germany",
                total: 92,
                living: 92,
                hasDetailedData: true,
                coordinates: [51.1657, 10.4515],
                zoom: 6,
                graduationYears: {
                    2014: 5, 2015: 6, 2016: 7, 2017: 8, 2018: 8, 2019: 9,
                    2020: 10, 2021: 11, 2022: 10, 2023: 9, 2024: 5, 2025: 4
                },
                gender: { Female: 52, Male: 40 },
                origins: {
                    "International": 45, "Euregio": 32, "Germany": 15
                },
                nationalities: {
                    "German": 38, "Dutch": 12, "Italian": 8, "Polish": 7, "Spanish": 6
                },
                fields: {
                    "Life Sciences": 22, "Neuroscience": 15, "Physical Sciences": 14,
                    "Business & Economics": 12, "Chemistry": 10, "Medicine & Health": 8
                },
                universities: [
                    { name: "Technical University of Munich", city: "Munich", count: 7, lat: 48.1497, lng: 11.5679, logo: "technical-university-of-munich.png" },
                    { name: "LMU Munich", city: "Munich", count: 6, lat: 48.1508, lng: 11.5802, logo: "lmu-munich.png" },
                    { name: "Heidelberg University", city: "Heidelberg", count: 5, lat: 49.4093, lng: 8.7063, logo: "heidelberg-university.png" },
                    { name: "RWTH Aachen", city: "Aachen", count: 8, lat: 50.7784, lng: 6.0594, logo: "rwth-aachen.png" },
                    { name: "Freie Universit√§t Berlin", city: "Berlin", count: 5, lat: 52.4537, lng: 13.2901, logo: "freie-universitat-berlin.png" }
                ],
                cities: [
                    { name: "Munich", count: 18 }, { name: "Berlin", count: 15 },
                    { name: "Aachen", count: 12 }, { name: "Cologne", count: 10 },
                    { name: "Frankfurt", count: 8 }, { name: "Heidelberg", count: 7 }
                ]
            },
            
            "United Kingdom": {
                code: "GB",
                displayName: "United Kingdom",
                total: 86,
                living: 71,
                hasDetailedData: true,
                coordinates: [55.3781, -3.4360],
                zoom: 5,
                graduationYears: {
                    2014: 4, 2015: 5, 2016: 6, 2017: 8, 2018: 9, 2019: 10,
                    2020: 11, 2021: 10, 2022: 9, 2023: 8, 2024: 4, 2025: 2
                },
                gender: { Female: 48, Male: 38 },
                origins: {
                    "International": 52, "British": 20, "Euregio": 14
                },
                nationalities: {
                    "British": 20, "Dutch": 15, "German": 12, "Italian": 10, "Belgian": 8
                },
                fields: {
                    "Neuroscience": 18, "Life Sciences": 16, "Physical Sciences": 14,
                    "Medicine & Health": 12, "Business & Economics": 10, "Chemistry": 8
                },
                universities: [
                    { name: "Imperial College London", city: "London", count: 19, lat: 51.4988, lng: -0.1749, logo: "imperial-college-london.png" },
                    { name: "UCL", city: "London", count: 14, lat: 51.5246, lng: -0.1340, logo: "ucl.png" },
                    { name: "University of Oxford", city: "Oxford", count: 7, lat: 51.7548, lng: -1.2544, logo: "university-of-oxford.png" },
                    { name: "University of Cambridge", city: "Cambridge", count: 7, lat: 52.2043, lng: 0.1149, logo: "university-of-cambridge.png" },
                    { name: "University of Edinburgh", city: "Edinburgh", count: 7, lat: 55.9445, lng: -3.1892, logo: "university-of-edinburgh.png" },
                    { name: "King's College London", city: "London", count: 6, lat: 51.5115, lng: -0.1160, logo: "kings-college-london.png" }
                ],
                cities: [
                    { name: "London", count: 42 }, { name: "Edinburgh", count: 10 },
                    { name: "Oxford", count: 8 }, { name: "Cambridge", count: 7 },
                    { name: "Manchester", count: 5 }
                ]
            },
            
            "Belgium": {
                code: "BE",
                displayName: "Belgium",
                total: 68,
                living: 68,
                hasDetailedData: true,
                coordinates: [50.5039, 4.4699],
                zoom: 8,
                graduationYears: {
                    2014: 3, 2015: 4, 2016: 5, 2017: 6, 2018: 7, 2019: 8,
                    2020: 9, 2021: 8, 2022: 7, 2023: 6, 2024: 3, 2025: 2
                },
                gender: { Female: 38, Male: 30 },
                origins: {
                    "Euregio": 35, "International": 20, "Belgian": 13
                },
                nationalities: {
                    "Belgian": 28, "Dutch": 15, "German": 8, "French": 6, "Italian": 5
                },
                fields: {
                    "Life Sciences": 18, "Neuroscience": 12, "Chemistry": 10,
                    "Medicine & Health": 9, "Business & Economics": 8, "Physical Sciences": 6
                },
                universities: [
                    { name: "KU Leuven", city: "Leuven", count: 21, lat: 50.8798, lng: 4.7005, logo: "ku-leuven.png" },
                    { name: "Ghent University", city: "Ghent", count: 8, lat: 51.0259, lng: 3.7119, logo: "ghent-university.png" },
                    { name: "Universit√© libre de Bruxelles", city: "Brussels", count: 6, lat: 50.8136, lng: 4.3831, logo: "universite-libre-de-bruxelles.png" },
                    { name: "University of Antwerp", city: "Antwerp", count: 5, lat: 51.2211, lng: 4.4051, logo: "university-of-antwerp.png" }
                ],
                cities: [
                    { name: "Leuven", count: 22 }, { name: "Brussels", count: 18 },
                    { name: "Ghent", count: 10 }, { name: "Antwerp", count: 8 },
                    { name: "Li√®ge", count: 5 }
                ]
            },
            
            "Sweden": {
                code: "SE",
                displayName: "Sweden",
                total: 55,
                living: 49,
                hasDetailedData: true,
                coordinates: [60.1282, 18.6435],
                zoom: 5,
                graduationYears: {
                    2015: 3, 2016: 4, 2017: 5, 2018: 6, 2019: 7,
                    2020: 8, 2021: 7, 2022: 6, 2023: 5, 2024: 3, 2025: 1
                },
                gender: { Female: 32, Male: 23 },
                origins: {
                    "International": 35, "Swedish": 12, "Euregio": 8
                },
                nationalities: {
                    "Swedish": 12, "Dutch": 10, "German": 9, "Italian": 6, "British": 5
                },
                fields: {
                    "Life Sciences": 14, "Neuroscience": 10, "Physical Sciences": 9,
                    "Medicine & Health": 8, "Chemistry": 6, "Environment": 5
                },
                universities: [
                    { name: "Uppsala University", city: "Uppsala", count: 18, lat: 59.8586, lng: 17.6389, logo: "uppsala-university.png" },
                    { name: "Lund University", city: "Lund", count: 12, lat: 55.7047, lng: 13.1910, logo: "lund-university.png" },
                    { name: "Karolinska Institutet", city: "Stockholm", count: 9, lat: 59.3498, lng: 18.0269, logo: "karolinska-institutet.png" },
                    { name: "Stockholm University", city: "Stockholm", count: 9, lat: 59.3639, lng: 18.0587, logo: "stockholm-university.png" }
                ],
                cities: [
                    { name: "Stockholm", count: 20 }, { name: "Uppsala", count: 15 },
                    { name: "Lund", count: 10 }, { name: "Gothenburg", count: 6 }
                ]
            },
            
            "Switzerland": {
                code: "CH",
                displayName: "Switzerland",
                total: 39,
                living: 39,
                hasDetailedData: true,
                coordinates: [46.8182, 8.2275],
                zoom: 7,
                graduationYears: {
                    2016: 3, 2017: 4, 2018: 5, 2019: 5, 2020: 6,
                    2021: 5, 2022: 4, 2023: 4, 2024: 2, 2025: 1
                },
                gender: { Female: 21, Male: 18 },
                origins: {
                    "International": 28, "Swiss": 6, "Euregio": 5
                },
                nationalities: {
                    "Swiss": 6, "Dutch": 8, "German": 7, "Italian": 5, "French": 5
                },
                fields: {
                    "Physical Sciences": 10, "Life Sciences": 8, "Neuroscience": 7,
                    "Chemistry": 5, "Computer Science": 5
                },
                universities: [
                    { name: "ETH Z√ºrich", city: "Z√ºrich", count: 8, lat: 47.3763, lng: 8.5479, logo: "eth-zurich.png" },
                    { name: "University of Z√ºrich", city: "Z√ºrich", count: 6, lat: 47.3744, lng: 8.5508, logo: "university-of-zurich.png" },
                    { name: "EPFL", city: "Lausanne", count: 5, lat: 46.5191, lng: 6.5668, logo: "epfl.png" },
                    { name: "University of Basel", city: "Basel", count: 5, lat: 47.5584, lng: 7.5827, logo: "university-of-basel.png" }
                ],
                cities: [
                    { name: "Z√ºrich", count: 16 }, { name: "Basel", count: 8 },
                    { name: "Geneva", count: 6 }, { name: "Lausanne", count: 5 }
                ]
            }
        };
        
        // Basic data for other countries (without detailed breakdown)
        const basicCountryData = {
            "Spain": { code: "ES", displayName: "Spain", total: 29, living: 29, coordinates: [40.4637, -3.7492], zoom: 6 },
            "Italy": { code: "IT", displayName: "Italy", total: 27, living: 27, coordinates: [41.8719, 12.5674], zoom: 6 },
            "France": { code: "FR", displayName: "France", total: 25, living: 25, coordinates: [46.2276, 2.2137], zoom: 6 },
            "United States": { code: "US", displayName: "United States", total: 22, living: 22, coordinates: [37.0902, -95.7129], zoom: 4 },
            "Denmark": { code: "DK", displayName: "Denmark", total: 21, living: 19, coordinates: [56.2639, 9.5018], zoom: 7 },
            "Austria": { code: "AT", displayName: "Austria", total: 15, living: 14, coordinates: [47.5162, 14.5501], zoom: 7 },
            "Canada": { code: "CA", displayName: "Canada", total: 15, living: 15, coordinates: [56.1304, -106.3468], zoom: 4 },
            "Norway": { code: "NO", displayName: "Norway", total: 12, living: 12, coordinates: [60.4720, 8.4689], zoom: 5 },
            "Luxembourg": { code: "LU", displayName: "Luxembourg", total: 11, living: 11, coordinates: [49.8153, 6.1296], zoom: 9 },
            "Australia": { code: "AU", displayName: "Australia", total: 10, living: 10, coordinates: [-25.2744, 133.7751], zoom: 4 },
            "Finland": { code: "FI", displayName: "Finland", total: 8, living: 8, coordinates: [61.9241, 25.7482], zoom: 5 },
            "Ireland": { code: "IE", displayName: "Ireland", total: 8, living: 6, coordinates: [53.4129, -8.2439], zoom: 6 },
            "China": { code: "CN", displayName: "China", total: 7, living: 7, coordinates: [35.8617, 104.1954], zoom: 4 },
            "Singapore": { code: "SG", displayName: "Singapore", total: 6, living: 6, coordinates: [1.3521, 103.8198], zoom: 11 },
            "Portugal": { code: "PT", displayName: "Portugal", total: 5, living: 5, coordinates: [39.3999, -8.2245], zoom: 6 },
            "Poland": { code: "PL", displayName: "Poland", total: 5, living: 5, coordinates: [51.9194, 19.1451], zoom: 6 }
        };
        
        // Get country data
        let countryData = alumniDatabase[countryParam] || basicCountryData[countryParam];
        
        // If country not found at all, redirect to Netherlands
        if (!countryData) {
            countryData = alumniDatabase["Netherlands"];
        }
        
        // ============================================
        // FETCH COUNTRY INFO FROM API
        // ============================================
        
        async function fetchCountryInfo() {
            try {
                const response = await fetch(`https://restcountries.com/v3.1/alpha/${countryData.code}`);
                const data = await response.json();
                const country = data[0];
                
                document.title = `${countryData.displayName} - MSP Alumni`;
                document.getElementById('flagImg').src = country.flags.svg;
                document.getElementById('countryName').textContent = countryData.displayName;
                
                const nativeNames = country.name.nativeName;
                if (nativeNames) {
                    const firstNative = Object.values(nativeNames)[0];
                    if (firstNative.common && firstNative.common !== country.name.common) {
                        document.getElementById('countryNative').textContent = firstNative.common;
                    }
                }
                
                document.getElementById('countryRegion').textContent = `${country.subregion} ¬∑ ${country.region}`;
                document.getElementById('factCapital').textContent = country.capital?.[0] || '-';
                document.getElementById('factPopulation').textContent = formatPopulation(country.population);
                document.getElementById('factArea').textContent = formatNumber(country.area);
                
                if (country.currencies) {
                    const currencyKey = Object.keys(country.currencies)[0];
                    const currency = country.currencies[currencyKey];
                    document.getElementById('factCurrency').textContent = `${currency.symbol || ''} ${currencyKey}`;
                }
                
                if (country.languages) {
                    document.getElementById('factLanguage').textContent = Object.values(country.languages)[0];
                }
                
                if (country.timezones) {
                    document.getElementById('factTimezone').textContent = country.timezones[0];
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('countryName').textContent = countryData.displayName;
            }
        }
        
        // ============================================
        // HELPERS
        // ============================================
        
        function formatPopulation(num) {
            if (num >= 1e9) return (num / 1e9).toFixed(1) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(0) + 'K';
            return num.toString();
        }
        
        function formatNumber(num) {
            return num?.toLocaleString() || '-';
        }
        
        function getFlagUrl(code) {
            return `https://flagcdn.com/w40/${code}.png`;
        }
        
        // ============================================
        // POPULATE STATS
        // ============================================
        
        function populateStats() {
            document.getElementById('statTotal').textContent = countryData.total;
            document.getElementById('statLiving').textContent = countryData.living;
            
            if (countryData.universities) {
                document.getElementById('statUnis').textContent = countryData.universities.length;
                document.getElementById('uniCount').textContent = countryData.universities.length;
            } else {
                document.getElementById('statUnis').textContent = '-';
                document.getElementById('uniCount').textContent = '-';
            }
        }
        
        // ============================================
        // MAP
        // ============================================
        
        function initMap() {
            const map = L.map('heroMap', {
                zoomControl: false,
                attributionControl: false
            }).setView(countryData.coordinates, countryData.zoom);
            
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);
            
            if (countryData.universities) {
                countryData.universities.forEach(uni => {
                    const size = Math.max(8, Math.min(uni.count / 3, 22));
                    
                    const marker = L.circleMarker([uni.lat, uni.lng], {
                        radius: size,
                        fillColor: '#00A2DB',
                        color: '#ffffff',
                        weight: 2,
                        opacity: 1,
                        fillOpacity: 0.8
                    }).addTo(map);
                    
                    marker.bindPopup(`
                        <div class="popup-card">
                            <div class="popup-header">
                                <div class="popup-logo">
                                    <img src="assets/logos/${uni.logo}" alt="${uni.name}" onerror="this.parentElement.innerHTML='üéì'">
                                </div>
                                <div>
                                    <div class="popup-name">${uni.name}</div>
                                    <div class="popup-city">${uni.city}</div>
                                </div>
                            </div>
                            <div class="popup-count">${uni.count} <span>alumni</span></div>
                        </div>
                    `, { maxWidth: 250 });
                    
                    marker.on('mouseover', function() {
                        this.setStyle({ fillOpacity: 1, radius: size * 1.15 });
                    });
                    marker.on('mouseout', function() {
                        this.setStyle({ fillOpacity: 0.8, radius: size });
                    });
                });
            } else {
                // Just show country marker
                L.circleMarker(countryData.coordinates, {
                    radius: 15,
                    fillColor: '#00A2DB',
                    color: '#ffffff',
                    weight: 2,
                    fillOpacity: 0.8
                }).addTo(map);
            }
        }
        
        // ============================================
        // CHARTS - Only if detailed data available
        // ============================================
        
        function createCharts() {
            if (!countryData.hasDetailedData) {
                // Show coming soon message
                document.getElementById('graphsSection').innerHTML = `
                    <div class="graphs-container">
                        <div class="coming-soon">
                            <div class="coming-soon-icon">üìä</div>
                            <h3>Detailed Data Coming Soon</h3>
                            <p>We're working on gathering detailed alumni statistics for ${countryData.displayName}. Check back soon!</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            // Graduation years
            if (countryData.graduationYears) {
                const container = document.getElementById('yearTimeline');
                const years = countryData.graduationYears;
                const maxVal = Math.max(...Object.values(years));
                
                Object.entries(years).forEach(([year, count]) => {
                    const height = (count / maxVal) * 120;
                    const bar = document.createElement('div');
                    bar.className = 'year-bar';
                    bar.innerHTML = `
                        <div class="year-bar-fill" style="height: ${height}px">
                            <span class="year-bar-value">${count}</span>
                        </div>
                        <div class="year-bar-label">'${year.slice(-2)}</div>
                    `;
                    container.appendChild(bar);
                });
            }
            
            // Gender donut
            if (countryData.gender) {
                const female = countryData.gender.Female;
                const male = countryData.gender.Male;
                const total = female + male;
                const femalePct = (female / total) * 100;
                
                const donut = document.getElementById('genderDonut');
                donut.style.background = `conic-gradient(#00A2DB 0% ${femalePct}%, #E84E10 ${femalePct}% 100%)`;
                donut.innerHTML = `<div class="donut-center"><div class="donut-center-value">${total}</div><div class="donut-center-label">Total</div></div>`;
                
                document.getElementById('genderLegend').innerHTML = `
                    <div class="legend-item"><div class="legend-color" style="background:#00A2DB"></div><span>Female</span><span class="legend-value">${female} (${femalePct.toFixed(0)}%)</span></div>
                    <div class="legend-item"><div class="legend-color" style="background:#E84E10"></div><span>Male</span><span class="legend-value">${male} (${(100-femalePct).toFixed(0)}%)</span></div>
                `;
            }
            
            // Bar charts
            if (countryData.origins) {
                createBarChart('originChart', countryData.origins, '');
            }
            
            if (countryData.fields) {
                createBarChart('fieldsChart', countryData.fields, 'dark');
            }
            
            if (countryData.nationalities) {
                createNationalitiesChart();
            }
        }
        
        function createBarChart(containerId, data, colorClass) {
            const container = document.getElementById(containerId);
            if (!container) return;
            
            const maxVal = Math.max(...Object.values(data));
            
            Object.entries(data).forEach(([label, value]) => {
                const pct = (value / maxVal) * 100;
                const row = document.createElement('div');
                row.className = 'bar-row';
                row.innerHTML = `
                    <div class="bar-label">${label}</div>
                    <div class="bar-track"><div class="bar-fill ${colorClass}" style="width: ${pct}%">${value}</div></div>
                `;
                container.appendChild(row);
            });
        }
        
        function createNationalitiesChart() {
            const container = document.getElementById('nationalitiesChart');
            if (!container || !countryData.nationalities) return;
            
            const data = countryData.nationalities;
            const maxVal = Math.max(...Object.values(data));
            
            Object.entries(data).forEach(([nationality, value]) => {
                const pct = (value / maxVal) * 100;
                const flagCode = nationalityFlags[nationality] || '';
                const flagHtml = flagCode ? `<img src="${getFlagUrl(flagCode)}" alt="" class="bar-flag">` : '';
                
                const row = document.createElement('div');
                row.className = 'bar-row';
                row.innerHTML = `
                    <div class="bar-label">${flagHtml}${nationality}</div>
                    <div class="bar-track"><div class="bar-fill orange" style="width: ${pct}%">${value}</div></div>
                `;
                container.appendChild(row);
            });
        }
        
        // ============================================
        // UNIVERSITIES
        // ============================================
        
        function populateUniversities() {
            const grid = document.getElementById('universityGrid');
            
            if (!countryData.universities || countryData.universities.length === 0) {
                document.getElementById('universitiesSection').innerHTML = `
                    <div class="universities-container">
                        <div class="coming-soon">
                            <div class="coming-soon-icon">üéì</div>
                            <h3>University Data Coming Soon</h3>
                            <p>We're compiling university destination data for ${countryData.displayName}.</p>
                        </div>
                    </div>
                `;
                return;
            }
            
            countryData.universities.forEach(uni => {
                const card = document.createElement('div');
                card.className = 'uni-card';
                card.innerHTML = `
                    <div class="uni-card-header">
                        <img src="assets/logos/${uni.logo}" alt="${uni.name}" onerror="this.style.display='none'">
                    </div>
                    <div class="uni-card-body">
                        <div class="uni-card-name">${uni.name}</div>
                        <div class="uni-card-city">${uni.city}</div>
                        <div class="uni-card-footer">
                            <div class="uni-card-count">${uni.count} <span>alumni</span></div>
                            <div class="uni-card-arrow">‚Üí</div>
                        </div>
                    </div>
                `;
                grid.appendChild(card);
            });
        }
        
        // ============================================
        // CITIES
        // ============================================
        
        function populateCities() {
            const grid = document.getElementById('citiesGrid');
            
            if (!countryData.cities || countryData.cities.length === 0) {
                document.getElementById('citiesSection').style.display = 'none';
                return;
            }
            
            countryData.cities.forEach((city, i) => {
                const btn = document.createElement('div');
                btn.className = i < 4 ? 'city-button' : 'city-button alt';
                btn.innerHTML = `${city.name} <span>${city.count}</span>`;
                grid.appendChild(btn);
            });
        }
        
        // ============================================
        // INIT
        // ============================================
        
        fetchCountryInfo();
        populateStats();
        initMap();
        createCharts();
        populateUniversities();
        populateCities();
    </script>
</body>
</html>
