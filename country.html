<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Country - MSP Alumni Network</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        :root {
            --dark-blue: #001C3D;
            --light-blue: #00A2DB;
            --bright-blue: #00d4ff;
            --orange: #E84E10;
            --white: #FFFFFF;
            --off-white: #f8f9fa;
            --gray-100: #f1f3f5;
            --gray-200: #e9ecef;
            --gray-400: #ced4da;
            --gray-600: #868e96;
            --gray-800: #343a40;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--white);
            color: var(--dark-blue);
            overflow-x: hidden;
        }
        
        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 100;
            padding: 20px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--gray-200);
        }
        
        .logo {
            font-size: 14px;
            font-weight: 700;
            color: var(--dark-blue);
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .logo-mark {
            width: 32px;
            height: 32px;
            background: var(--dark-blue);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 11px;
            font-weight: 800;
        }
        
        .back-link {
            font-size: 14px;
            color: var(--gray-600);
            text-decoration: none;
            transition: color 0.2s;
        }
        
        .back-link:hover {
            color: var(--dark-blue);
        }
        
        /* Hero Section with Flag Background */
        .hero {
            min-height: 100vh;
            display: grid;
            grid-template-columns: 1fr 1fr;
            padding-top: 80px;
            position: relative;
        }
        
        .hero-left {
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 80px;
            position: relative;
            overflow: hidden;
        }
        
        .flag-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.08;
            background-size: cover;
            background-position: center;
            z-index: 0;
        }
        
        .hero-content {
            position: relative;
            z-index: 1;
        }
        
        .country-label {
            font-size: 12px;
            font-weight: 600;
            color: var(--light-blue);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 20px;
        }
        
        .country-name {
            font-size: 64px;
            font-weight: 900;
            letter-spacing: -3px;
            line-height: 1;
            margin-bottom: 15px;
            color: var(--dark-blue);
        }
        
        .country-native {
            font-size: 18px;
            color: var(--gray-400);
            font-weight: 500;
            font-style: italic;
            margin-bottom: 30px;
        }
        
        .country-region {
            font-size: 16px;
            color: var(--gray-600);
            margin-bottom: 50px;
        }
        
        .quick-facts {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 25px;
        }
        
        .fact {
            border-left: 3px solid var(--light-blue);
            padding-left: 15px;
        }
        
        .fact.orange {
            border-left-color: var(--orange);
        }
        
        .fact-value {
            font-size: 20px;
            font-weight: 700;
            color: var(--dark-blue);
        }
        
        .fact-label {
            font-size: 11px;
            color: var(--gray-600);
            margin-top: 4px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* Map on the right */
        .hero-right {
            position: relative;
            background: var(--off-white);
        }
        
        #heroMap {
            width: 100%;
            height: 100%;
            min-height: 500px;
        }
        
        .map-overlay {
            position: absolute;
            bottom: 30px;
            left: 30px;
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            z-index: 1000;
        }
        
        .map-overlay-title {
            font-size: 12px;
            color: var(--gray-600);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }
        
        .map-overlay-value {
            font-size: 28px;
            font-weight: 800;
            color: var(--dark-blue);
        }
        
        /* Big Stats Section */
        .big-stats {
            padding: 100px 80px;
            background: var(--dark-blue);
            color: white;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 60px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        .big-stat {
            text-align: center;
        }
        
        .big-stat-number {
            font-size: 72px;
            font-weight: 900;
            letter-spacing: -3px;
            line-height: 1;
            background: linear-gradient(135deg, var(--light-blue) 0%, var(--bright-blue) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .big-stat-number.orange {
            background: linear-gradient(135deg, var(--orange) 0%, #ff6b35 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .big-stat-label {
            font-size: 14px;
            color: rgba(255,255,255,0.6);
            margin-top: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        /* Graphs Section */
        .graphs-section {
            padding: 100px 80px;
            background: var(--white);
        }
        
        .graphs-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 40px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .graph-card {
            background: var(--off-white);
            border-radius: 20px;
            padding: 35px;
        }
        
        .graph-card.full-width {
            grid-column: span 2;
        }
        
        .graph-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--dark-blue);
            margin-bottom: 25px;
        }
        
        /* Bar Chart */
        .bar-chart {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .bar-row {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .bar-label {
            font-size: 13px;
            font-weight: 500;
            color: var(--gray-800);
            min-width: 120px;
        }
        
        .bar-container {
            flex: 1;
            height: 28px;
            background: var(--gray-200);
            border-radius: 14px;
            overflow: hidden;
        }
        
        .bar-fill {
            height: 100%;
            border-radius: 14px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 12px;
            font-size: 12px;
            font-weight: 600;
            color: white;
            min-width: 40px;
            transition: width 1s ease;
        }
        
        .bar-fill.blue {
            background: linear-gradient(90deg, var(--light-blue), var(--bright-blue));
        }
        
        .bar-fill.orange {
            background: linear-gradient(90deg, var(--orange), #ff6b35);
        }
        
        .bar-fill.dark {
            background: linear-gradient(90deg, var(--dark-blue), #003366);
        }
        
        /* Donut Chart */
        .donut-container {
            display: flex;
            align-items: center;
            gap: 40px;
        }
        
        .donut-chart {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .donut-center {
            width: 100px;
            height: 100px;
            background: var(--off-white);
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .donut-center-value {
            font-size: 28px;
            font-weight: 800;
            color: var(--dark-blue);
        }
        
        .donut-center-label {
            font-size: 10px;
            color: var(--gray-600);
            text-transform: uppercase;
        }
        
        .donut-legend {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .legend-color {
            width: 14px;
            height: 14px;
            border-radius: 4px;
        }
        
        .legend-text {
            font-size: 14px;
            color: var(--gray-800);
        }
        
        .legend-value {
            font-weight: 700;
            margin-left: auto;
        }
        
        /* Year Timeline */
        .year-timeline {
            display: flex;
            align-items: flex-end;
            gap: 8px;
            height: 200px;
            padding-top: 30px;
        }
        
        .year-bar {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }
        
        .year-bar-fill {
            width: 100%;
            background: linear-gradient(180deg, var(--light-blue), var(--bright-blue));
            border-radius: 6px 6px 0 0;
            transition: height 1s ease;
            position: relative;
            min-height: 10px;
        }
        
        .year-bar-value {
            position: absolute;
            top: -24px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 11px;
            font-weight: 700;
            color: var(--dark-blue);
        }
        
        .year-bar-label {
            font-size: 10px;
            color: var(--gray-600);
            font-weight: 500;
        }
        
        /* Universities Section */
        .universities-section {
            padding: 100px 80px;
            background: var(--off-white);
        }
        
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 40px;
            max-width: 1200px;
            margin-left: auto;
            margin-right: auto;
        }
        
        .section-title {
            font-size: 12px;
            font-weight: 600;
            color: var(--orange);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 10px;
        }
        
        .section-heading {
            font-size: 36px;
            font-weight: 800;
            letter-spacing: -1px;
            color: var(--dark-blue);
        }
        
        .section-count {
            font-size: 14px;
            color: var(--gray-600);
        }
        
        .section-count span {
            font-weight: 700;
            color: var(--dark-blue);
        }
        
        .university-list {
            display: flex;
            flex-direction: column;
            gap: 2px;
            background: var(--gray-200);
            border-radius: 16px;
            overflow: hidden;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .university-row {
            display: grid;
            grid-template-columns: 50px 70px 1fr 180px 80px;
            align-items: center;
            gap: 25px;
            padding: 20px 30px;
            background: white;
            transition: all 0.2s ease;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
        }
        
        .university-row:hover {
            background: var(--gray-100);
        }
        
        .uni-rank {
            font-size: 14px;
            font-weight: 700;
            color: var(--gray-400);
        }
        
        .uni-logo {
            width: 50px;
            height: 50px;
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 6px;
        }
        
        .uni-logo img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .uni-info h3 {
            font-size: 15px;
            font-weight: 600;
            color: var(--dark-blue);
            margin-bottom: 2px;
        }
        
        .uni-info p {
            font-size: 13px;
            color: var(--gray-600);
        }
        
        .uni-bar {
            height: 8px;
            background: var(--gray-200);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .uni-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--light-blue), var(--bright-blue));
            border-radius: 4px;
        }
        
        .uni-count {
            font-size: 22px;
            font-weight: 700;
            color: var(--dark-blue);
            text-align: right;
        }
        
        /* Cities Section */
        .cities-section {
            padding: 100px 80px;
            background: white;
        }
        
        .cities-wrapper {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .cities-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 40px;
        }
        
        .city-pill {
            padding: 14px 24px;
            background: var(--gray-100);
            border-radius: 100px;
            font-size: 14px;
            font-weight: 500;
            color: var(--dark-blue);
            transition: all 0.2s;
            cursor: default;
        }
        
        .city-pill:hover {
            background: var(--light-blue);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,162,219,0.2);
        }
        
        .city-pill span {
            font-weight: 700;
            margin-left: 8px;
            opacity: 0.7;
        }
        
        .city-pill:hover span {
            opacity: 1;
        }
        
        /* Footer */
        footer {
            padding: 50px 80px;
            background: var(--dark-blue);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .footer-logo {
            color: white;
            font-size: 14px;
            font-weight: 600;
        }
        
        .footer-links {
            display: flex;
            gap: 30px;
        }
        
        .footer-links a {
            color: rgba(255,255,255,0.6);
            text-decoration: none;
            font-size: 13px;
            transition: color 0.2s;
        }
        
        .footer-links a:hover {
            color: white;
        }
        
        /* Leaflet popup overrides */
        .leaflet-popup-content-wrapper {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.15);
            padding: 0;
            overflow: hidden;
        }
        
        .leaflet-popup-content {
            margin: 0;
            font-family: 'Inter', sans-serif;
            min-width: 220px;
        }
        
        .leaflet-popup-tip {
            background: white;
        }
        
        .popup-card {
            padding: 20px;
        }
        
        .popup-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .popup-logo {
            width: 50px;
            height: 50px;
            background: var(--off-white);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 8px;
            flex-shrink: 0;
        }
        
        .popup-logo img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .popup-text {
            flex: 1;
        }
        
        .popup-name {
            font-size: 16px;
            font-weight: 700;
            color: var(--dark-blue);
            line-height: 1.2;
        }
        
        .popup-city {
            font-size: 13px;
            color: var(--gray-600);
            margin-top: 3px;
        }
        
        .popup-stats {
            display: flex;
            align-items: baseline;
            gap: 8px;
            padding-top: 15px;
            border-top: 1px solid var(--gray-200);
        }
        
        .popup-count {
            font-size: 32px;
            font-weight: 800;
            color: var(--light-blue);
        }
        
        .popup-count-label {
            font-size: 13px;
            color: var(--gray-600);
        }
        
        /* Responsive */
        @media (max-width: 1100px) {
            .hero {
                grid-template-columns: 1fr;
            }
            
            .hero-left {
                padding: 60px 40px;
            }
            
            .hero-right {
                height: 400px;
            }
            
            .country-name {
                font-size: 48px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 30px;
            }
            
            .big-stat-number {
                font-size: 48px;
            }
            
            .graphs-section,
            .universities-section,
            .cities-section {
                padding: 60px 30px;
            }
            
            .graphs-grid {
                grid-template-columns: 1fr;
            }
            
            .graph-card.full-width {
                grid-column: span 1;
            }
            
            .university-row {
                grid-template-columns: 40px 50px 1fr 60px;
            }
            
            .uni-bar { display: none; }
        }
        
        @media (max-width: 600px) {
            header {
                padding: 15px 20px;
            }
            
            .hero-left {
                padding: 40px 20px;
            }
            
            .country-name {
                font-size: 36px;
            }
            
            .quick-facts {
                grid-template-columns: 1fr 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
                gap: 30px;
            }
            
            .big-stat-number {
                font-size: 56px;
            }
            
            .big-stats {
                padding: 60px 20px;
            }
            
            .donut-container {
                flex-direction: column;
            }
            
            .year-timeline {
                overflow-x: auto;
            }
            
            .year-bar {
                min-width: 35px;
            }
            
            .university-row {
                grid-template-columns: 40px 1fr 50px;
                gap: 12px;
                padding: 15px 20px;
            }
            
            .uni-logo { display: none; }
            
            footer {
                flex-direction: column;
                gap: 20px;
                padding: 40px 20px;
                text-align: center;
            }
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header>
        <a href="index.html" class="logo">
            <span class="logo-mark">UM</span>
            MSP Alumni
        </a>
        <a href="index.html" class="back-link">Back to World Map</a>
    </header>
    
    <!-- Hero with Flag Background + Map -->
    <section class="hero">
        <div class="hero-left">
            <div class="flag-background" id="flagBg"></div>
            <div class="hero-content">
                <div class="country-label">Country Profile</div>
                <h1 class="country-name" id="countryName">the Netherlands</h1>
                <p class="country-native" id="countryNative"></p>
                <p class="country-region" id="countryRegion"></p>
                
                <div class="quick-facts">
                    <div class="fact">
                        <div class="fact-value" id="factCapital">-</div>
                        <div class="fact-label">Capital</div>
                    </div>
                    <div class="fact">
                        <div class="fact-value" id="factPopulation">-</div>
                        <div class="fact-label">Population</div>
                    </div>
                    <div class="fact orange">
                        <div class="fact-value" id="factArea">-</div>
                        <div class="fact-label">Area (km²)</div>
                    </div>
                    <div class="fact">
                        <div class="fact-value" id="factCurrency">-</div>
                        <div class="fact-label">Currency</div>
                    </div>
                    <div class="fact">
                        <div class="fact-value" id="factLanguage">-</div>
                        <div class="fact-label">Language</div>
                    </div>
                    <div class="fact orange">
                        <div class="fact-value" id="factTimezone">-</div>
                        <div class="fact-label">Timezone</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="hero-right">
            <div id="heroMap"></div>
            <div class="map-overlay">
                <div class="map-overlay-title">Universities</div>
                <div class="map-overlay-value" id="uniCount">11</div>
            </div>
        </div>
    </section>
    
    <!-- Big Stats -->
    <section class="big-stats">
        <div class="stats-grid">
            <div class="big-stat">
                <div class="big-stat-number" id="statTotal">487</div>
                <div class="big-stat-label">Total Alumni</div>
            </div>
            <div class="big-stat">
                <div class="big-stat-number" id="statLiving">445</div>
                <div class="big-stat-label">Living Here</div>
            </div>
            <div class="big-stat">
                <div class="big-stat-number orange" id="statUnis">11</div>
                <div class="big-stat-label">Universities</div>
            </div>
        </div>
    </section>
    
    <!-- Graphs Section -->
    <section class="graphs-section">
        <div class="graphs-grid">
            
            <!-- Graduation Years -->
            <div class="graph-card full-width">
                <div class="graph-title">Alumni by Graduation Year</div>
                <div class="year-timeline" id="yearTimeline">
                    <!-- Populated by JS -->
                </div>
            </div>
            
            <!-- Gender Distribution -->
            <div class="graph-card">
                <div class="graph-title">Gender Distribution</div>
                <div class="donut-container">
                    <div class="donut-chart" id="genderDonut"></div>
                    <div class="donut-legend" id="genderLegend">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>
            
            <!-- Origin Regions -->
            <div class="graph-card">
                <div class="graph-title">Where They Come From</div>
                <div class="bar-chart" id="originChart">
                    <!-- Populated by JS -->
                </div>
            </div>
            
            <!-- Fields of Study -->
            <div class="graph-card full-width">
                <div class="graph-title">Fields of Study</div>
                <div class="bar-chart" id="fieldsChart">
                    <!-- Populated by JS -->
                </div>
            </div>
            
            <!-- Top Nationalities -->
            <div class="graph-card full-width">
                <div class="graph-title">Top Nationalities</div>
                <div class="bar-chart" id="nationalitiesChart">
                    <!-- Populated by JS -->
                </div>
            </div>
            
        </div>
    </section>
    
    <!-- Universities Section -->
    <section class="universities-section">
        <div class="section-header">
            <div>
                <div class="section-title">Education</div>
                <h2 class="section-heading">Universities</h2>
            </div>
            <div class="section-count"><span id="uniTotal">11</span> institutions</div>
        </div>
        
        <div class="university-list" id="universityList">
            <!-- Populated by JS -->
        </div>
    </section>
    
    <!-- Cities Section -->
    <section class="cities-section">
        <div class="cities-wrapper">
            <div class="section-title">Living</div>
            <h2 class="section-heading">Where alumni call home</h2>
            
            <div class="cities-grid" id="citiesGrid">
                <!-- Populated by JS -->
            </div>
        </div>
    </section>
    
    <!-- Footer -->
    <footer>
        <div class="footer-logo">Maastricht University · Faculty of Science and Engineering</div>
        <div class="footer-links">
            <a href="index.html">World Map</a>
            <a href="#">Contact</a>
        </div>
    </footer>
    
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // ============================================
        // GET COUNTRY FROM URL
        // ============================================
        
        const urlParams = new URLSearchParams(window.location.search);
        const countryParam = urlParams.get('country') || 'Netherlands';
        
        // ============================================
        // ALUMNI DATA (from database analysis)
        // ============================================
        
        const alumniDatabase = {
            "Netherlands": {
                code: "NL",
                displayName: "the Netherlands",
                total: 487,
                living: 445,
                coordinates: [52.1326, 5.2913],
                zoom: 7,
                graduationYears: {
                    2014: 5, 2015: 10, 2016: 22, 2017: 22, 2018: 19, 2019: 24,
                    2020: 40, 2021: 50, 2022: 52, 2023: 63, 2024: 65, 2025: 73
                },
                gender: { Female: 265, Male: 180 },
                origins: {
                    "International": 272,
                    "Euregio": 71,
                    "Netherlands": 51,
                    "Limburg": 51
                },
                nationalities: {
                    "Dutch": 151, "German": 43, "Belgian": 34, "Italian": 26,
                    "British": 17, "Spanish": 17, "Polish": 15, "Romanian": 11, "French": 9
                },
                fields: {
                    "Biomedical Sciences": 103,
                    "Biology & Ecology": 68,
                    "Neuroscience": 37,
                    "Physics": 36,
                    "Business": 32,
                    "Chemistry": 30,
                    "Medicine & Health": 22,
                    "Computer Science": 18
                },
                universities: [
                    { name: "Maastricht University", city: "Maastricht", count: 121, lat: 50.8514, lng: 5.6910, logo: "maastricht-university.png" },
                    { name: "Utrecht University", city: "Utrecht", count: 82, lat: 52.0855, lng: 5.1744, logo: "utrecht-university.png" },
                    { name: "University of Amsterdam", city: "Amsterdam", count: 58, lat: 52.3559, lng: 4.9552, logo: "university-of-amsterdam.png" },
                    { name: "Leiden University", city: "Leiden", count: 41, lat: 52.1575, lng: 4.4856, logo: "leiden-university.png" },
                    { name: "Wageningen University", city: "Wageningen", count: 37, lat: 51.9692, lng: 5.6654, logo: "wageningen-university.png" },
                    { name: "Radboud University", city: "Nijmegen", count: 36, lat: 51.8207, lng: 5.8656, logo: "radboud-university.png" },
                    { name: "University of Groningen", city: "Groningen", count: 23, lat: 53.2194, lng: 6.5665, logo: "university-of-groningen.png" },
                    { name: "TU Delft", city: "Delft", count: 17, lat: 52.0021, lng: 4.3734, logo: "tu-delft.png" },
                    { name: "VU Amsterdam", city: "Amsterdam", count: 14, lat: 52.3340, lng: 4.8668, logo: "vrije-universiteit-amsterdam.png" },
                    { name: "TU Eindhoven", city: "Eindhoven", count: 9, lat: 51.4478, lng: 5.4904, logo: "eindhoven-university.png" },
                    { name: "Erasmus University", city: "Rotterdam", count: 4, lat: 51.9173, lng: 4.5260, logo: "erasmus-university.png" }
                ],
                cities: [
                    { name: "Maastricht", count: 100 },
                    { name: "Amsterdam", count: 92 },
                    { name: "Utrecht", count: 71 },
                    { name: "Leiden", count: 34 },
                    { name: "Wageningen", count: 18 },
                    { name: "Groningen", count: 18 },
                    { name: "Nijmegen", count: 18 },
                    { name: "Eindhoven", count: 10 },
                    { name: "Rotterdam", count: 8 },
                    { name: "The Hague", count: 7 },
                    { name: "Delft", count: 7 }
                ]
            }
        };
        
        const countryData = alumniDatabase[countryParam] || alumniDatabase["Netherlands"];
        
        // ============================================
        // FETCH COUNTRY INFO FROM API
        // ============================================
        
        async function fetchCountryInfo() {
            try {
                const response = await fetch(`https://restcountries.com/v3.1/alpha/${countryData.code}`);
                const data = await response.json();
                const country = data[0];
                
                document.title = `${countryData.displayName} - MSP Alumni Network`;
                
                // Flag background
                document.getElementById('flagBg').style.backgroundImage = `url('${country.flags.svg}')`;
                
                // Name
                document.getElementById('countryName').textContent = countryData.displayName;
                
                // Native name
                const nativeNames = country.name.nativeName;
                if (nativeNames) {
                    const firstNative = Object.values(nativeNames)[0];
                    if (firstNative.common && firstNative.common !== country.name.common) {
                        document.getElementById('countryNative').textContent = firstNative.common;
                    }
                }
                
                // Region
                document.getElementById('countryRegion').textContent = `${country.subregion} · ${country.region}`;
                
                // Facts
                document.getElementById('factCapital').textContent = country.capital?.[0] || '-';
                document.getElementById('factPopulation').textContent = formatPopulation(country.population);
                document.getElementById('factArea').textContent = formatNumber(country.area);
                
                if (country.currencies) {
                    const currencyKey = Object.keys(country.currencies)[0];
                    const currency = country.currencies[currencyKey];
                    document.getElementById('factCurrency').textContent = `${currency.symbol || ''} ${currencyKey}`;
                }
                
                if (country.languages) {
                    document.getElementById('factLanguage').textContent = Object.values(country.languages)[0];
                }
                
                if (country.timezones) {
                    document.getElementById('factTimezone').textContent = country.timezones[0];
                }
                
            } catch (error) {
                console.error('Error:', error);
            }
        }
        
        // ============================================
        // HELPERS
        // ============================================
        
        function formatPopulation(num) {
            if (num >= 1e9) return (num / 1e9).toFixed(1) + 'B';
            if (num >= 1e6) return (num / 1e6).toFixed(1) + 'M';
            if (num >= 1e3) return (num / 1e3).toFixed(0) + 'K';
            return num.toString();
        }
        
        function formatNumber(num) {
            return num?.toLocaleString() || '-';
        }
        
        // ============================================
        // MAP WITH LOGOS IN POPUPS
        // ============================================
        
        function initMap() {
            const map = L.map('heroMap', {
                zoomControl: false,
                attributionControl: false
            }).setView(countryData.coordinates, countryData.zoom);
            
            L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);
            
            countryData.universities.forEach(uni => {
                const size = Math.max(12, Math.min(uni.count / 4, 28));
                
                const marker = L.circleMarker([uni.lat, uni.lng], {
                    radius: size,
                    fillColor: '#00A2DB',
                    color: '#ffffff',
                    weight: 3,
                    opacity: 1,
                    fillOpacity: 0.8
                }).addTo(map);
                
                // Popup with logo, name, city
                marker.bindPopup(`
                    <div class="popup-card">
                        <div class="popup-header">
                            <div class="popup-logo">
                                <img src="assets/logos/${uni.logo}" alt="${uni.name}" onerror="this.parentElement.style.display='none'">
                            </div>
                            <div class="popup-text">
                                <div class="popup-name">${uni.name}</div>
                                <div class="popup-city">${uni.city}</div>
                            </div>
                        </div>
                        <div class="popup-stats">
                            <div class="popup-count">${uni.count}</div>
                            <div class="popup-count-label">alumni</div>
                        </div>
                    </div>
                `, { className: 'custom-popup', maxWidth: 280 });
                
                marker.on('mouseover', function() {
                    this.setStyle({ fillOpacity: 1, radius: size * 1.2 });
                });
                marker.on('mouseout', function() {
                    this.setStyle({ fillOpacity: 0.8, radius: size });
                });
            });
        }
        
        // ============================================
        // GRAPHS
        // ============================================
        
        function createYearTimeline() {
            const container = document.getElementById('yearTimeline');
            const years = countryData.graduationYears;
            const maxVal = Math.max(...Object.values(years));
            
            Object.entries(years).forEach(([year, count]) => {
                const height = (count / maxVal) * 150;
                const bar = document.createElement('div');
                bar.className = 'year-bar';
                bar.innerHTML = `
                    <div class="year-bar-fill" style="height: ${height}px">
                        <span class="year-bar-value">${count}</span>
                    </div>
                    <div class="year-bar-label">${year.slice(-2)}</div>
                `;
                container.appendChild(bar);
            });
        }
        
        function createGenderDonut() {
            const female = countryData.gender.Female;
            const male = countryData.gender.Male;
            const total = female + male;
            const femalePct = (female / total) * 100;
            
            const donut = document.getElementById('genderDonut');
            donut.style.background = `conic-gradient(
                #00A2DB 0% ${femalePct}%,
                #E84E10 ${femalePct}% 100%
            )`;
            donut.innerHTML = `
                <div class="donut-center">
                    <div class="donut-center-value">${total}</div>
                    <div class="donut-center-label">Total</div>
                </div>
            `;
            
            const legend = document.getElementById('genderLegend');
            legend.innerHTML = `
                <div class="legend-item">
                    <div class="legend-color" style="background:#00A2DB"></div>
                    <span class="legend-text">Female</span>
                    <span class="legend-value">${female} (${femalePct.toFixed(0)}%)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color" style="background:#E84E10"></div>
                    <span class="legend-text">Male</span>
                    <span class="legend-value">${male} (${(100-femalePct).toFixed(0)}%)</span>
                </div>
            `;
        }
        
        function createBarChart(containerId, data, colorClass = 'blue') {
            const container = document.getElementById(containerId);
            const maxVal = Math.max(...Object.values(data));
            
            Object.entries(data).forEach(([label, value]) => {
                const pct = (value / maxVal) * 100;
                const row = document.createElement('div');
                row.className = 'bar-row';
                row.innerHTML = `
                    <div class="bar-label">${label}</div>
                    <div class="bar-container">
                        <div class="bar-fill ${colorClass}" style="width: ${pct}%">${value}</div>
                    </div>
                `;
                container.appendChild(row);
            });
        }
        
        // ============================================
        // STATS
        // ============================================
        
        function populateStats() {
            document.getElementById('statTotal').textContent = countryData.total;
            document.getElementById('statLiving').textContent = countryData.living;
            document.getElementById('statUnis').textContent = countryData.universities.length;
            document.getElementById('uniCount').textContent = countryData.universities.length;
            document.getElementById('uniTotal').textContent = countryData.universities.length;
        }
        
        // ============================================
        // UNIVERSITIES
        // ============================================
        
        function populateUniversities() {
            const list = document.getElementById('universityList');
            const maxCount = countryData.universities[0].count;
            
            countryData.universities.forEach((uni, i) => {
                const row = document.createElement('a');
                row.href = `university.html?name=${encodeURIComponent(uni.name)}`;
                row.className = 'university-row';
                
                const barWidth = (uni.count / maxCount) * 100;
                
                row.innerHTML = `
                    <div class="uni-rank">${String(i + 1).padStart(2, '0')}</div>
                    <div class="uni-logo">
                        <img src="assets/logos/${uni.logo}" alt="${uni.name}" onerror="this.style.display='none'">
                    </div>
                    <div class="uni-info">
                        <h3>${uni.name}</h3>
                        <p>${uni.city}</p>
                    </div>
                    <div class="uni-bar">
                        <div class="uni-bar-fill" style="width: ${barWidth}%"></div>
                    </div>
                    <div class="uni-count">${uni.count}</div>
                `;
                
                list.appendChild(row);
            });
        }
        
        // ============================================
        // CITIES
        // ============================================
        
        function populateCities() {
            const container = document.getElementById('citiesGrid');
            
            countryData.cities.forEach(city => {
                const pill = document.createElement('div');
                pill.className = 'city-pill';
                pill.innerHTML = `${city.name} <span>${city.count}</span>`;
                container.appendChild(pill);
            });
        }
        
        // ============================================
        // INIT
        // ============================================
        
        fetchCountryInfo();
        populateStats();
        initMap();
        createYearTimeline();
        createGenderDonut();
        createBarChart('originChart', countryData.origins, 'blue');
        createBarChart('fieldsChart', countryData.fields, 'dark');
        createBarChart('nationalitiesChart', countryData.nationalities, 'orange');
        populateUniversities();
        populateCities();
    </script>
</body>
</html>
